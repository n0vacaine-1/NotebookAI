<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NotebookAI</title>
  <style>
    body { margin:0; font-family:Arial,sans-serif; background:#f9f9f9; color:#222; display:flex; height:100vh; }
    .sidebar { width:260px; background:#fff; border-right:1px solid #ddd; padding:20px; box-sizing:border-box; display:flex; flex-direction:column; }
    .sidebar h2{font-size:18px;margin-bottom:15px;}
    .sidebar textarea{width:100%;height:150px;padding:8px;border:1px solid #ccc;border-radius:6px;resize:none;font-size:14px;}
    .sidebar button{margin-top:10px;padding:10px;background:#2563eb;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:0.2s;}
    .sidebar button:hover{background:#1e4ed8;}
    .main{flex:1;display:flex;flex-direction:column;}
    .topbar{height:50px;background:#fff;border-bottom:1px solid #ddd;display:flex;align-items:center;justify-content:space-between;padding:0 20px;}
    .topbar h1{font-size:20px;font-weight:bold;}
    .topbar .actions button{margin-left:10px;padding:6px 12px;border:1px solid #ccc;border-radius:6px;background:#f5f5f5;cursor:pointer;}
    .workspace{flex:1;overflow-y:auto;padding:20px;background:#fafafa url("https://www.transparenttextures.com/patterns/lined-paper.png");}
    .output{background:#fff;border:1px solid #ddd;border-radius:8px;padding:15px;min-height:200px;white-space:pre-wrap;line-height:1.5;}
    .right{width:240px;background:#fff;border-left:1px solid #ddd;padding:20px;box-sizing:border-box;display:flex;flex-direction:column;}
    .right h2{font-size:16px;margin-bottom:10px;}
    .right button{padding:10px;margin-bottom:10px;border:none;border-radius:6px;color:#fff;cursor:pointer;transition:0.2s;}
    .right .summarize{background:#2563eb;}
    .right .summarize:hover{background:#1e4ed8;}
    .right .simplify{background:#16a34a;}
    .right .simplify:hover{background:#15803d;}
    .right .study{background:#9333ea;}
    .right .study:hover{background:#7e22ce;}
    select{width:100%;padding:6px;border:1px solid #ccc;border-radius:6px;margin-bottom:12px;}
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>Sources</h2>
    <textarea id="inputText" placeholder="Paste text here..."></textarea>
    <button onclick="clearText()">Clear</button>
  </div>

  <div class="main">
    <div class="topbar">
      <h1>NotebookAI</h1>
      <div class="actions">
        <button id="copyBtn" onclick="copyOutput()">Copy</button>
        <button id="downloadBtn" onclick="downloadOutput()">Download</button>
      </div>
    </div>
    <div class="workspace">
      <h2>Output</h2>
      <div id="loading" style="font-weight:bold; color:#2563eb; margin-bottom:10px;">Loading AI model... Please wait ⏳</div>
      <div class="output" id="outputBox">Your summary will appear here.</div>
    </div>
  </div>

  <div class="right">
    <h2>Actions</h2>
    <button id="summarizeBtn" class="summarize" onclick="askAI('summary')" disabled>Summarize</button>
    <button id="simplifyBtn" class="simplify" onclick="askAI('simplify')" disabled>Simplify</button>
    <button id="studyBtn" class="study" onclick="askAI('paragraph')" disabled>Study Paragraph</button>

    <h2>Settings</h2>
    <label>Reading Level</label>
    <select id="readingLevel">
      <option>Basic</option>
      <option>Intermediate</option>
      <option>Advanced</option>
    </select>
    <label>Length</label>
    <select id="length">
      <option>Short</option>
      <option>Medium</option>
      <option>Detailed</option>
    </select>
    <label>Tone</label>
    <select id="tone">
      <option>Neutral</option>
      <option>Friendly</option>
      <option>Academic</option>
    </select>
  </div>

  <script type="module">
    import { pipeline } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers/dist/transformers.min.js';

    let summarizer;
    const loadingDiv = document.getElementById("loading");
    const summarizeBtn = document.getElementById("summarizeBtn");
    const simplifyBtn = document.getElementById("simplifyBtn");
    const studyBtn = document.getElementById("studyBtn");

    async function init() {
      loadingDiv.style.display = "block";
      // Load summarization model
      summarizer = await pipeline('summarization', 'Xenova/distilbart-cnn-12-6');
      loadingDiv.style.display = "none";
      // Enable buttons after model is ready
      summarizeBtn.disabled = false;
      simplifyBtn.disabled = false;
      studyBtn.disabled = false;
    }
    init();

    async function askAI(type) {
      const input = document.getElementById("inputText").value.trim();
      const outputBox = document.getElementById("outputBox");
      if (!input) {
        outputBox.innerText = "⚠️ Please paste some text first.";
        return;
      }

      outputBox.innerText = "Processing...";

      try {
        let text = "";
        if (type === "summary") {
          const result = await summarizer(input, { max_length: 200 });
          text = result[0].summary_text;
        } else if (type === "simplify") {
          // Simple browser-based simplification
          text = input
            .split(". ")
            .map(s => s.trim())
            .map(s => s.length > 80 ? s.slice(0, 80) + "..." : s)
            .join(". ");
        } else { // study paragraph
          const result = await summarizer(input, { max_length: 250 });
          text = "Key Ideas:\n" + result[0].summary_text + "\n\nQuestions:\n- What are the main points?\n- How can this be applied?";
        }
        outputBox.innerText = text;
      } catch (err) {
        outputBox.innerText = "Error: " + err.message;
      }
    }

    function clearText() {
      document.getElementById("inputText").value = "";
      document.getElementById("outputBox").innerText = "Your summary will appear here.";
    }

    function copyOutput() {
      const text = document.getElementById("outputBox").innerText;
      navigator.clipboard.writeText(text);
      alert("Copied to clipboard!");
    }

    function downloadOutput() {
      const text = document.getElementById("outputBox").innerText;
      const blob = new Blob([text], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "NotebookAI_Output.txt";
      link.click();
    }
  </script>
</body>
</html>
